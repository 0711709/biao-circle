(function(t){function e(e){for(var s,i,o=e[0],c=e[1],u=e[2],d=0,v=[];d<o.length;d++)i=o[d],r[i]&&v.push(r[i][0]),r[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);l&&l(e);while(v.length)v.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],s=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(s=!1)}s&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var s={},r={app:0},a=[];function i(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=s,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},2723:function(t,e,n){"use strict";var s=n("9f87"),r=n.n(s);r.a},"430c":function(t,e,n){t.exports=n.p+"img/helloworld.7a02f540.jpg"},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var s=n("2b0e"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{attrs:{id:"top"}},[s("div",{staticClass:"container"},[s("div",{staticClass:"left"},[s("router-link",{staticClass:"logo",attrs:{to:"/"}},[s("img",{attrs:{src:n("f430"),alt:"logo"}})]),t._m(0)],1),s("div",{staticClass:"right"},[s("router-link",{attrs:{to:"/"}},[t._v("首页")]),t.session.loggedin()?s("span",{staticClass:"loggedin"},[s("router-link",{attrs:{to:"/member"}},[t._v(t._s(t.session.user().username))]),s("router-link",{attrs:{to:"/setting/me"}},[t._v("设置")]),s("span",{on:{click:function(e){t.session.logout()}}},[t._v("登出")])],1):s("span",{staticClass:"guest"},[s("router-link",{attrs:{to:"/login"}},[t._v("登陆")]),s("router-link",{attrs:{to:"/signup"}},[t._v("注册")])],1)],1)])]),s("router-view"),t._m(1)],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search"},[n("input",{attrs:{type:"search",placeholder:"此功能未实现"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"footer"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"link-group"},[n("span",[t._v("感谢 VUE ")])])])])}],i=(n("f771"),n("585e"),n("f499")),o=n.n(i);function c(t,e){localStorage.setItem(t,o()(e))}function u(t){var e=localStorage.getItem(t);return e?JSON.parse(e):null}var l={set:c,get:u};function d(){return localStorage.getItem("sessionId")}function v(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";localStorage.setItem("sessionId",t),l.set("user",e),location.href=n}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";localStorage.removeItem("sessionId"),localStorage.removeItem("user"),location.href=t}function p(){return l.get("user")}var f={user:p,login:v,logout:m,loggedin:d},h={name:"app",components:{},data:function(){return{session:f}}},_=h,g=n("2877"),w=Object(g["a"])(_,r,a,!1,null,null,null);w.options.__file="App.vue";var C=w.exports,b=n("8c4f"),y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"section"},[t._m(0),t._l(t.list,function(e,s){return n("div",{key:s,staticClass:"box"},[n("div",{staticClass:"post"},[t._m(1,!0),n("div",{staticClass:"right"},[n("router-link",{attrs:{to:"post/"+e.id}},[n("div",{staticClass:"title"},[t._v(t._s(e.title))])]),n("div",{staticClass:"info"},[t._v(t._s(e.$user?e.$user.username:"-")+" 发布于 "+t._s(e.create_at))])],1),e.$user&&t.session.user()&&e.$user.id===t.session.user().id?n("div",{staticClass:"operate"},[n("button",{on:{click:function(n){t.postDelete(e.id)}}},[t._v("删除")])]):t._e()])])}),n("scrollLoad",{attrs:{page:1,totalPage:t.totalPage,pending:t.pending},on:{flip:t.onFlip}})],2),n("div",{staticClass:"side"},[t.session.user()?n("div",{staticClass:"box"},[n("div",{staticClass:"me"},[n("router-link",{staticClass:"post",attrs:{to:"/member"}},[t._v(t._s(t.session.user().username))]),n("router-link",{staticClass:"post",attrs:{to:"/member"}},[t._v("创建新主题")])],1)]):t._e(),t._m(2)])])])},k=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cat-group box"},[n("div",{staticClass:"cat active"},[t._v("全部")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"left"},[s("img",{attrs:{src:n("430c"),alt:"img"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("div",{staticClass:"state"},[n("div",{staticClass:"cell"},[t._v("社区指导原则")]),n("div",{staticClass:"inner"},[n("ul",[n("li",[n("span",[t._v("尊重原创")]),n("div",[t._v("请不要在表圈子发布任何盗版下载链接，包括软件、音乐、电影等等。表圈子是创意工作者的社区，我们尊重原创。")])]),n("li",[n("span",[t._v("友好互助")]),n("div",[t._v("保持对陌生人的友善。用知识去帮助别人。")])])])])])])}],P=n("75fc"),x=n("0a0d"),$=n.n(x),O=n("bc3a"),M=n.n(O),E="e02e228f1fea1ba69135e5ce251ed4288d67490e41a161fee3ef7389dcf4ebf2",S=$()();function V(t,e){return btoa(t+e)}function j(t,e){return M.a.post("https://mock.biaoyansu.com/api/1/".concat(t),e,{headers:{"BIAO-MOCK-APP-KEY":E,"BIAO-MOCK-TIMESTAMP":S,"BIAO-MOCK-SIGNATURE":V(E,S)}}).then(function(t){return t.data})}var N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"scroll-load"},[t.noMore?n("div",[t._v("没有更多了")]):n("button",{on:{click:t.next}},[t.pending?n("span",[t._v("加载中...")]):n("span",[t._v("加载更多")])])])},A=[],D={props:["page","flip","pending","totalPage"],data:function(){return{current:1,noMore:!1}},mounted:function(){this.current=this.page||1,this.bindScroll()},methods:{next:function(){if(!this.pending)return this.current>=this.totalPage?this.noMore=!0:(this.$emit("flip",++this.current),this.current===this.totalPage?this.noMore=!0:void 0)},bindScroll:function(){var t=this;window.addEventListener("scroll",function(e){t.calcRemain()<10&&t.next()})},calcRemain:function(){var t=document.documentElement,e=t.scrollHeight,n=t.scrollTop,s=window.innerHeight,r=e-s-n;return r}}},B=D,I=(n("f89c"),Object(g["a"])(B,N,A,!1,null,"658d6526",null));I.options.__file="ScrollLoad.vue";var U=I.exports,F={components:{scrollLoad:U},data:function(){return{list:[],session:f,readParams:{limit:8,page:1,with:[{model:"user",relation:"belongs_to"}]},totalPage:0,pending:!1}},mounted:function(){this.read()},methods:{read:function(){var t=this;j("post/read",this.readParams).then(function(e){t.list=[].concat(Object(P["a"])(t.list),Object(P["a"])(e.data)),t.pending=!1,t.totalPage=Math.ceil(e.total/t.readParams.limit)})},postDelete:function(t){var e=this;j("post/delete",{id:t}).then(function(t){t.success&&e.read()})},onFlip:function(t){this.readParams.page=t,this.pending=!0,this.read()}}},T=F,L=Object(g["a"])(T,y,k,!1,null,null,null);L.options.__file="Home.vue";var K=L.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"section",attrs:{id:"post"}},[t.current.title?n("div",[n("div",{staticClass:"box"},[n("div",{staticClass:"title"},[t._v(t._s(t.current.title))]),n("div",{staticClass:"info"},[n("span",[t._v(t._s(t.name(t.current)||"-"))]),n("span",[t._v("发布于")]),n("span",[t._v(t._s(t.current.create_at))])])]),n("div",{staticClass:"box content"},[t._v(t._s(t.current.content))]),n("div",{staticClass:"comment-area"},t._l(t.comment,function(e,s){return n("div",{key:s,staticClass:"box comment"},[n("div",{staticClass:"head"},[n("span",[t._v(t._s(t.name(e)))]),n("span",[t._v("发布于")]),n("span",[t._v(t._s(e.create_at))])]),n("div",{staticClass:"content"},[t._v(t._s(e.content))])])}),0),t.session.user()?n("div",{staticClass:"box sub-comment"},[n("form",{on:{submit:function(e){e.preventDefault(),t.commentCreate()}}},[n("div",{staticClass:"head"},[t._v("添加回复")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.content,expression:"form.content"}],attrs:{placeholder:"请尽量让自己的回复可以帮助其他人"},domProps:{value:t.form.content},on:{input:function(e){e.target.composing||t.$set(t.form,"content",e.target.value)}}}),n("button",[t._v("回复")])])]):t._e()]):n("div",[t._v("\n        加载中...\n        "),n("i",{staticClass:"fas fa-spinner"})])]),n("div",{staticClass:"side"},[n("div",{staticClass:"box"},[t.session.user()?n("div",{staticClass:"me"},[n("router-link",{staticClass:"post",attrs:{to:"/member"}},[t._v(t._s(t.session.user().username))]),n("router-link",{staticClass:"post",attrs:{to:"/member"}},[t._v("创建新主题")])],1):t._e()])])])])},R=[],z={pad:function(t){return t="0"+t,t.substr(-2)},format:function(t){var e=t.getFullYear(),n=this.pad(t.getMonth()+1),s=this.pad(t.getDate()),r=this.pad(t.getHours()),a=this.pad(t.getMinutes()),i=this.pad(t.getSeconds());return"".concat(e,"-").concat(n,"-").concat(s," ").concat(r,":").concat(a,":").concat(i)}},W=function(t){return t.$user&&(t.$user.nickname||t.$user.username)},H={data:function(){return{current:[],session:f,name:W,comment:[],form:{}}},mounted:function(){this.readPost(),this.readComment()},methods:{readPost:function(){var t=this;j("post/find",{id:this.$route.params.id,with:[{model:"user",relation:"belongs_to"}]}).then(function(e){t.current=e.data})},readComment:function(){var t=this;j("comment/read",{where:{and:{post_id:this.$route.params.id}},with:[{model:"user",relation:"belongs_to"}]}).then(function(e){t.comment=e.data})},commentCreate:function(){var t=this;this.form.user_id=this.session.user().id,this.form.post_id=this.$route.params.id,this.form.create_at=z.format(new Date),this.form.content&&this.form.user_id&&j("comment/create",this.form).then(function(e){t.readComment(),t.form={}})}}},Z=H,J=Object(g["a"])(Z,q,R,!1,null,null,null);J.options.__file="Post.vue";var Y=J.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"section"},[n("div",{staticClass:"header"},[t._v("注册")]),n("div",{attrs:{id:"sign-up"}},[n("form",{on:{submit:function(e){return e.preventDefault(),t.validateSignup(e)}}},[n("div",{staticClass:"input-control"},[n("label",[n("span",[t._v("用户名")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.username,expression:"current.username"}],attrs:{type:"text"},domProps:{value:t.current.username},on:{focus:function(e){t.error.username=!1},input:function(e){e.target.composing||t.$set(t.current,"username",e.target.value)}}}),t.error.username?n("span",{staticClass:"error"},[t._v(t._s(t.error.username))]):t._e()])]),n("div",{staticClass:"input-control"},[n("label",[n("span",[t._v("密码")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.password,expression:"current.password"}],attrs:{type:"password"},domProps:{value:t.current.password},on:{focus:function(e){t.error.password=!1},input:function(e){e.target.composing||t.$set(t.current,"password",e.target.value)}}}),t.error.password?n("span",{staticClass:"error"},[t._v(t._s(t.error.password))]):t._e()])]),n("div",{staticClass:"input-control"},[n("label",[n("span",[t._v("重复密码")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.password2,expression:"current.password2"}],attrs:{type:"password"},domProps:{value:t.current.password2},on:{focus:function(e){t.error.password2=!1},input:function(e){e.target.composing||t.$set(t.current,"password2",e.target.value)}}}),t.error.password2?n("span",{staticClass:"error"},[t._v(t._s(t.error.password2))]):t._e()])]),n("button",{attrs:{type:"submit"}},[t._v("注册")])])])]),t._m(0)])])},Q=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"side"},[n("div",{staticClass:"box"},[n("div",{staticClass:"header"},[t._v("表圈子")]),n("div",{staticClass:"intro"},[t._v("十八相送一水黑")])])])}],X={data:function(){return{current:{},error:{username:null,password:null,password2:null}}},mounted:function(){j("user/read").then(function(t){console.log(t.data)})},methods:{validateSignup:function(){var t=this;if(this.validateCurrent()){var e={where:{and:{username:this.current.username}}};j("user/exists",e).then(function(e){e.data?t.error.username="用户名已存在":t.signup()})}},validateCurrent:function(){var t=this.error,e=this.current.username,n=this.current.password,s=this.current.password2,r=!e||!e||/[\W_]/.test(e)||e.length<4||e.length>20,a=!n||n.length<6,i=!s||s!==n;return t.username=r?"用户名格式有误,长度应在4到20位之间":null,t.password=a?"密码长度应大于6位":null,t.password2=i?"两次密码输入不一致":null,!t.username&&!t.password},signup:function(){var t=this;j("user/create",this.current).then(function(e){e.success&&(t.current={},t.$router.push("/login"))})}}},tt=X,et=Object(g["a"])(tt,G,Q,!1,null,null,null);et.options.__file="Signup.vue";var nt=et.exports,st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"section"},[n("div",{staticClass:"header"},[t._v("登陆")]),n("div",{attrs:{id:"log-in"}},[n("form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[n("div",{staticClass:"input-control"},[n("label",[n("span",[t._v("用户名")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.username,expression:"current.username"}],attrs:{type:"text"},domProps:{value:t.current.username},on:{input:function(e){e.target.composing||t.$set(t.current,"username",e.target.value)}}})])]),n("div",{staticClass:"input-control"},[n("label",[n("span",[t._v("密码")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.password,expression:"current.password"}],attrs:{type:"password"},domProps:{value:t.current.password},on:{input:function(e){e.target.composing||t.$set(t.current,"password",e.target.value)}}})])]),t.inValidMatch?n("div",{staticClass:"error"},[t._v("用户名或密码错误")]):t._e(),n("button",{attrs:{type:"submit"}},[t._v("登陆")]),t._m(0)])])]),t._m(1)])])},rt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("h3",[t._v("测试账号")]),n("div",[n("div",[n("span",[t._v("管理员:")]),n("span",[t._v("test")])]),n("div",[n("span",[t._v("密码:")]),n("span",[t._v("111111")])])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"side"},[n("div",{staticClass:"box"},[n("div",{staticClass:"header"},[t._v("表圈子")]),n("div",{staticClass:"intro"},[t._v("十八相送一水黑")])])])}],at={data:function(){return{current:{},inValidMatch:!1}},methods:{login:function(){var t=this,e=this.current.username,n=this.current.password;if(e&&n){var s={where:{and:{username:e,password:n}},except:["password"]};j("user/first",s).then(function(e){var n=e.data;if(n)return"test"===n.username?(n.IS_ADMIN=!0,void f.login(n.id,n,"/#/admin")):void f.login(n.id,n,"/");t.inValidMatch=!0})}}}},it=at,ot=(n("91ee"),Object(g["a"])(it,st,rt,!1,null,"c03ffba0",null));ot.options.__file="Login.vue";var ct=ot.exports,ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"section"},[n("div",{staticClass:"box profile"},[t._m(0),n("div",{staticClass:"me"},[n("div",[t._v(t._s(t.me.username))]),n("div",[t._v("表圈子第 "+t._s(t.me.id)+" 位会员")])])]),n("div",{staticClass:"box"},[n("button",{on:{click:function(e){t.postOrCancel=!t.postOrCancel}}},[t.postOrCancel?n("span",[t._v("取消创建")]):n("span",[t._v("创建新主题")])])]),t.postOrCancel?n("div",[n("div",{staticClass:"box"},[n("span",[t._v("主题标题")]),n("span",{staticClass:"msg",class:{error:t.error.title}},[t._v("120字数以内且不能为空")])]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.title,expression:"current.title"}],staticClass:"box",attrs:{type:"text",placeholder:"请输入主题标题,如果标题能够表达完整内容,则正文可以为空"},domProps:{value:t.current.title},on:{input:function(e){e.target.composing||t.$set(t.current,"title",e.target.value)}}}),n("div",{staticClass:"box"},[n("span",[t._v("正文")]),n("span",{staticClass:"msg",class:{error:t.error.content}},[t._v("200字数以内")])]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.current.content,expression:"current.content"}],attrs:{rows:"20"},domProps:{value:t.current.content},on:{input:function(e){e.target.composing||t.$set(t.current,"content",e.target.value)}}}),n("div",{staticClass:"box"},[n("button",{on:{click:t.postCreate}},[t._v("发布主题")])])]):t._e(),t._m(1),t._l(t.list,function(e,s){return n("div",{key:s,staticClass:"box"},[n("div",{staticClass:"post"},[t._m(2,!0),n("div",{staticClass:"right"},[n("router-link",{staticClass:"title",attrs:{to:"post/"+e.id}},[t._v(t._s(e.title))]),n("div",{staticClass:"info"},[t._v(t._s(t.me.username)+" 发布于 "+t._s(e.create_at))])],1),n("div",{staticClass:"operate"},[n("button",{on:{click:function(n){t.postEdit(e)}}},[t._v("编辑")]),n("button",{on:{click:function(n){t.postDelete(e.id)}}},[t._v("删除")])])])])})],2),t._m(3)])])},lt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"thumb"},[s("img",{attrs:{src:n("430c"),alt:"me"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box thread"},[n("div",{staticClass:"cat active"},[t._v("时间线")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"left"},[s("img",{attrs:{src:n("430c"),alt:"img"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"side"},[n("div",{staticClass:"box"},[n("div",{staticClass:"cell"},[t._v("社区指导原则")]),n("div",{staticClass:"inner"},[n("ul",[n("li",[n("span",[t._v("尊重原创")]),n("div",[t._v("请不要在表圈子发布任何盗版下载链接，包括软件、音乐、电影等等。表圈子是创意工作者的社区，我们尊重原创。")])]),n("li",[n("span",[t._v("友好互助")]),n("div",[t._v("保持对陌生人的友善。用知识去帮助别人。")])])])])])])}],dt={data:function(){return{postOrCancel:!1,me:{},current:{},list:[],error:{title:!1,content:!1,create:!1}}},mounted:function(){this.me=l.get("user"),this.thread()},methods:{postCreate:function(){var t=this;if(!this.current.title||this.current.title.length>120)this.error.title=!0;else if(this.current.content.length>200)this.error.content=!0;else{this.error.title=this.error.content=!1,this.current.user_id=this.me.id,this.current.create_at=z.format(new Date);var e="post/create";this.current.id&&(e="post/update"),j(e,this.current).then(function(e){e.success,t.current={},t.postOrCancel=!1,t.thread()})}},thread:function(){var t=this;j("post/read",{where:{and:{user_id:this.me.id}}}).then(function(e){t.list=e.data})},postEdit:function(t){this.current=t,this.postOrCancel=!0},postDelete:function(t){var e=this;j("post/delete",{id:t}).then(function(t){t.success&&e.thread()})}}},vt=dt,mt=Object(g["a"])(vt,ut,lt,!1,null,null,null);mt.options.__file="Member.vue";var pt=mt.exports,ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"side-left"},[n("div",{staticClass:"box-left"},[n("div",{staticClass:"header"},[t._v("个人设置")]),n("router-link",{staticClass:"item",attrs:{"active-class":"current",to:"/setting/me"}},[t._v("基础信息")]),n("router-link",{staticClass:"item",attrs:{"active-class":"current",to:"/setting/security"}},[t._v("安全设置")])],1)]),n("div",{staticClass:"section-right"},[n("router-view")],1)])])},ht=[],_t={},gt=_t,wt=Object(g["a"])(gt,ft,ht,!1,null,null,null);wt.options.__file="Setting.vue";var Ct=wt.exports,bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"setting"},[n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("基础信息设置")]),n("div",{staticClass:"edit",class:{editActive:t.editModel},on:{click:t.editOrCancel}},[t.editModel?n("span",[t._v("取消")]):t._e(),t._v("编辑\n    ")])]),n("fieldset",{attrs:{disabled:t.updatePending}},[n("table",[n("tbody",[n("tr",[n("td",[t._v("昵称")]),n("td",[t.me.nickname||t.editModel?t._e():n("span",[t._v("--")]),t.editModel||t.me.nickname?n("input",{directives:[{name:"model",rawName:"v-model",value:t.me.nickname,expression:"me.nickname"}],attrs:{type:"text",readonly:!t.editModel},domProps:{value:t.me.nickname},on:{focus:function(e){t.error.nickname=!1},input:function(e){e.target.composing||t.$set(t.me,"nickname",e.target.value)}}}):t._e()]),n("td",[t.error.nickname?n("span",{staticClass:"error"},[t._v("昵称长度应小于20位")]):t._e()])]),n("tr",[n("td",[t._v("用户名")]),n("td",[t.me.username||t.editModel?t._e():n("span",[t._v("--")]),t.editModel||t.me.username?n("input",{directives:[{name:"model",rawName:"v-model",value:t.me.username,expression:"me.username"}],attrs:{type:"text",readonly:!t.editModel},domProps:{value:t.me.username},on:{focus:function(e){t.error.username=!1},input:function(e){e.target.composing||t.$set(t.me,"username",e.target.value)}}}):t._e()]),n("td",[t.error.username?n("span",{staticClass:"error"},[t._v(t._s(t.error.username))]):t._e()])]),n("tr",[n("td",[t._v("签名")]),n("td",[t.me.info||t.editModel?t._e():n("span",[t._v("--")]),t.editModel||t.me.info?n("input",{directives:[{name:"model",rawName:"v-model",value:t.me.info,expression:"me.info"}],attrs:{type:"text",readonly:!t.editModel},domProps:{value:t.me.info},on:{focus:function(e){t.error.info=!1},input:function(e){e.target.composing||t.$set(t.me,"info",e.target.value)}}}):t._e()]),n("td",[t.error.info?n("span",{staticClass:"error"},[t._v("签名长度小于50位")]):t._e()])]),t.editModel?n("tr",[n("td"),n("td",[n("button",{on:{click:t.validateAndUpdate}},[t._v("保存更改")])])]):t._e()])])])])},yt=[],kt=n("cebc"),Pt={data:function(){return{me:{},saveMe:{},editModel:!1,updatePending:!1,error:{username:!1,nickname:!1,info:!1}}},mounted:function(){this.me=l.get("user"),this.saveMe=Object(kt["a"])({},this.me)},methods:{editOrCancel:function(){this.editModel=!this.editModel,this.error.username=!1,this.me=l.get("user")},validateAndUpdate:function(){var t=this;if(!(this.inValidateUsername()||this.inValidateNickname()||this.inValidateInfo()))if(this.error.nickname=this.error.username=this.error.info=!1,this.saveMe.nickname!==this.me.nickname||this.saveMe.username!==this.me.username||this.saveMe.info!==this.me.info){this.updatePending=!0;var e={where:{and:{username:this.me.username}}};j("user/exists",e).then(function(e){var n=t.saveMe.username!==t.me.username;if(e.data&&n)return t.updatePending=!1,void(t.error.username="用户名已存在");t.updateUsername()})}else this.editModel=!1},updateUsername:function(){var t=this;j("user/update",this.me).then(function(e){e.success&&(t.me=e.data,l.set("user",e.data),t.editModel=!1,t.updatePending=!1,window.location.reload())})},inValidateNickname:function(){return this.error.nickname=this.me.nickname.length>20},inValidateUsername:function(){if(!this.me.username||/[\W_]/.test(this.me.username)||this.me.username.length<4||this.me.username.length>20)return this.error.username="用户名格式有误,长度应介于4到20之间",!0},inValidateInfo:function(){return this.error.info=this.me.info.length>50}}},xt=Pt,$t=Object(g["a"])(xt,bt,yt,!1,null,null,null);$t.options.__file="SettingMe.vue";var Ot=$t.exports,Mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"setting"},[t._m(0),n("fieldset",{attrs:{disabled:t.changePasswordPending}},[n("table",[n("thead",[n("tr",[n("th",[t._v("密码设置")]),n("th",{staticClass:"text-left",on:{click:t.changeOrCancel}},[n("button",[t.changePasswordVisible?n("span",[t._v("取消")]):t._e(),n("span",[t._v("修改")]),t.changePasswordVisible?t._e():n("span",[t._v("密码")])])]),n("th",[t.changePasswordSuccess?n("span",{staticClass:"success"},[t._v(t._s(t.changePasswordSuccess))]):t._e(),t.changePasswordFail?n("span",{staticClass:"fail"},[t._v(t._s(t.changePasswordFail))]):t._e()])])]),t.changePasswordVisible?n("tbody",[n("tr",[n("td",[t._v("旧密码")]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password.old,expression:"password.old"}],attrs:{type:"password"},domProps:{value:t.password.old},on:{focus:function(e){t.errorPassword.old1=t.errorPassword.old2=t.changePasswordFail=!1},input:function(e){e.target.composing||t.$set(t.password,"old",e.target.value)}}})]),n("td",[t.errorPassword.old1?n("span",{staticClass:"error"},[t._v("请输入旧密码")]):t._e(),t.errorPassword.old2?n("span",{staticClass:"error"},[t._v("旧密码有误")]):t._e()])]),n("tr",[n("td",[t._v("新密码")]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password.new,expression:"password.new"}],attrs:{type:"password"},domProps:{value:t.password.new},on:{focus:function(e){t.errorPassword.new=t.changePasswordFail=!1},input:function(e){e.target.composing||t.$set(t.password,"new",e.target.value)}}})]),n("td",[t.errorPassword.new?n("span",{staticClass:"error"},[t._v("密码长度需大于6位")]):t._e()])]),n("tr",[n("td",[t._v("重复密码")]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password.repeat,expression:"password.repeat"}],attrs:{type:"password"},domProps:{value:t.password.repeat},on:{focus:function(e){t.errorPassword.repeat=t.changePasswordFail=!1},input:function(e){e.target.composing||t.$set(t.password,"repeat",e.target.value)}}})]),n("td",[t.errorPassword.repeat?n("span",{staticClass:"error"},[t._v("两次密码输入不一致")]):t._e()])]),n("tr",[n("td"),n("td",[n("button",{on:{click:t.validateAndChangePassword}},[t._v("提交更改")])])])]):t._e()])])])},Et=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("安全信息设置")])])}],St=(n("14b9"),{data:function(){return{changePasswordVisible:!1,password:{},user:l.get("user"),errorPassword:{old1:!1,old2:!1,new:!1,repeat:!1},changePasswordPending:!1,changePasswordSuccess:!1,changePasswordFail:!1}},methods:{changeOrCancel:function(){for(var t in this.changePasswordVisible=!this.changePasswordVisible,this.password={},this.errorPassword)this.errorPassword[t]=!1},validateAndChangePassword:function(){var t=this,e=this.user,n=this.password.old;if(!(this.inValidateOld1()||this.inValidateNew()||this.inValidateRepeat())){var s={id:e.id,only:["password"]};j("user/find",s).then(function(e){n===e.data.password?t.changePassword():t.errorPassword.old2="旧密码有误"})}},changePassword:function(){var t=this;this.errorPassword.old=!1,this.changePasswordPending=!0,j("user/update",{id:this.user.id,password:this.password.new}).then(function(e){e.success?(t.changePasswordPending=!1,t.changePasswordVisible=!1,t.password={},t.changePasswordSuccess="密码修改成功",setTimeout(function(){t.changePasswordSuccess=!1},2e3)):(t.changePasswordPending=!1,t.password={},t.changePasswordFail="密码修改失败")})},inValidateOld1:function(){return this.errorPassword.old1=!this.password.old},inValidateNew:function(){return this.errorPassword.new=!this.password.new||this.password.new.length<6},inValidateRepeat:function(){return this.errorPassword.repeat=!this.password.repeat||this.password.repeat!==this.password.new}}}),Vt=St,jt=Object(g["a"])(Vt,Mt,Et,!1,null,null,null);jt.options.__file="SettingSecurity.vue";var Nt=jt.exports,At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{staticClass:"container"},[n("div",{staticClass:"side-left"},[n("div",{staticClass:"box-left"},[n("div",{staticClass:"header"},[n("router-link",{attrs:{to:"/admin"}},[t._v("管理")])],1),n("router-link",{staticClass:"item",attrs:{"active-class":"current",to:"/admin/user"}},[t._v("管理用户")]),n("router-link",{staticClass:"item",attrs:{"active-class":"current",to:"/admin/post"}},[t._v("管理帖子")]),n("router-link",{staticClass:"item",attrs:{"active-class":"current",to:"/admin/cat"}},[t._v("管理分类")]),n("router-link",{staticClass:"item",attrs:{"active-class":"current",to:"/admin/comment"}},[t._v("管理评论")])],1)]),n("div",{staticClass:"section-right"},["/admin"==t.$route.path?n("div",[n("div",{attrs:{id:"admin"}},[t._m(0),n("div",{staticClass:"admin-search"},[n("h3",[t._v("搜索页面")]),n("Dropdown",{attrs:{searchModel:t.searchModel,onSelected:t.onSelected}})],1)])]):n("router-view")],1)])])},Dt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("管理")])])}],Bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dropdown"}},[n("div",{staticClass:"filter"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"search-type",on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.selected=e.target.multiple?n:n[0]},t.model]}},t._l(t.searchModel,function(e,s){return n("option",{key:s},[t._v(t._s(e.key))])}),0),n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"search",placeholder:"此功能未完全实现"},domProps:{value:t.keyword},on:{focus:function(e){t.show=!0},blur:t.hide,input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]),n("div",{staticClass:"search-list"},[t.show?n("span",t._l(t.result,function(e,s){return n("div",{key:s,on:{mousedown:function(n){t.select(e)}}},[t._v(t._s(e[t.searchModel[t.searchKey].displayBy]))])}),0):t._e()])])},It=[],Ut={props:["searchModel","onSelected"],data:function(){return{selected:"用户",searchKey:"user",keyword:"",allResult:{},result:[],show:!1,timer:null}},watch:{keyword:function(){this.debounceFilterAsync()}},mounted:function(){this.read()},methods:{model:function(){for(var t in this.searchModel)this.searchModel[t].key===this.selected&&(this.searchKey=t,this.read(),this.keyword="")},read:function(){var t=this;j("".concat(this.searchKey,"/read")).then(function(e){t.result=e.data})},filterAsync:function(t){var e=this,n={};t&&(n={query:'where("'.concat([this.searchModel[this.searchKey].searchBy],'" contains "').concat(t,'")')}),j("".concat(this.searchKey,"/read"),n).then(function(t){e.result=t.data})},debounceFilterAsync:function(){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.filterAsync(t.keyword)},300)},select:function(t){this.keyword=t[this.searchModel[this.searchKey].displayBy],this.onSelected&&this.onSelected(t)},hide:function(){var t=this;setTimeout(function(){t.show=!1},10)}}},Ft=Ut,Tt=(n("e58e"),Object(g["a"])(Ft,Bt,It,!1,null,"21f7fd28",null));Tt.options.__file="Dropdown.vue";var Lt=Tt.exports,Kt={components:{Dropdown:Lt},data:function(){return{searchModel:{cat:{key:"分类",searchBy:"name",displayBy:"name"},post:{key:"帖子",searchBy:"title",displayBy:"title"},user:{key:"用户",searchBy:"username",displayBy:"username"}}}},methods:{onSelected:function(t){console.log(t)}}},qt=Kt,Rt=(n("d76d"),Object(g["a"])(qt,At,Dt,!1,null,"19a031f6",null));Rt.options.__file="AdminBase.vue";var zt=Rt.exports,Wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"admin"}},[t._m(0),n("div",{staticClass:"create-user"},[n("button",{on:{click:function(e){t.createOrCancel=!t.createOrCancel,t.current={},t.errors={}}}},[0==t.createOrCancel?n("span",[t._v("创建用户")]):n("span",[t._v("取消创建")])]),t.createOrCancel?n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.createOrUpdate(e)}}},[n("label",{on:{keyup:function(e){t.debounceValidate("username")}}},[n("div",[t._v("用户名")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.username,expression:"current.username"}],attrs:{type:"text"},domProps:{value:t.current.username},on:{input:function(e){e.target.composing||t.$set(t.current,"username",e.target.value)}}}),t._l(t.errors.username,function(e,s){return n("div",{key:s,staticClass:"error"},[e?n("div",[t._v(t._s(t.rules.username[s].msg))]):t._e()])})],2),n("label",{on:{keyup:function(e){t.debounceValidate("nickname")}}},[n("div",[t._v("昵称")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.nickname,expression:"current.nickname"}],attrs:{type:"text"},domProps:{value:t.current.nickname},on:{input:function(e){e.target.composing||t.$set(t.current,"nickname",e.target.value)}}}),t._l(t.errors.nickname,function(e,s){return n("div",{key:s,staticClass:"error"},[e?n("div",[t._v(t._s(t.rules.nickname[s].msg))]):t._e()])})],2),n("label",{on:{keyup:function(e){t.debounceValidate("password")}}},[n("div",[t._v("密码")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.password,expression:"current.password"}],attrs:{type:"password"},domProps:{value:t.current.password},on:{input:function(e){e.target.composing||t.$set(t.current,"password",e.target.value)}}}),t._l(t.errors.password,function(e,s){return n("div",{key:s,staticClass:"error"},[e?n("div",[t._v(t._s(t.rules.password[s].msg))]):t._e()])})],2),n("button",{attrs:{type:"submit"}},[t._v("提交")])])]):t._e()]),n("div",{staticClass:"list"},[n("table",[t._m(1),n("tbody",t._l(t.list,function(e,s){return n("tr",{key:s},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.username))]),n("td",[t._v(t._s(e.nickname||"-"))]),n("td",[t._v(t._s(e.info||"-"))]),n("td",[n("button",{on:{click:function(n){t.createOrCancel=!0,t.current=e}}},[t._v("更新")]),n("button",{on:{click:function(n){t.deleteUser(e.id)}}},[t._v("删除")])])])}),0)]),n("Pagination",{attrs:{total:t.total,limit:t.readParams.limit,onChange:t.filp}})],1)])},Ht=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("用户管理")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("ID")]),n("th",[t._v("用户名")]),n("th",[t._v("昵称")]),n("th",[t._v("签名")]),n("th",[t._v("操作")])])}],Zt=n("bd86"),Jt=(n("3b2b"),n("6762"),n("2fdb"),n("aef6"),n("f559"),n("6b54"),{numeric:function(t){return!!/^\d+$/.test(t.toString())},required:function(t){return!(!t&&0!==t)},min:function(t,e){return!(t<e)},max:function(t,e){return!(t>e)},between:function(t,e,n){return!(!this.min(t,e)||!this.max(t,n))},positive:function(t){return!!this.numeric(t)&&!(t<=0)},negative:function(t){return!!this.numeric(t)&&!(t>=0)},minLength:function(t,e){return!(t.length<e)},maxLength:function(t,e){return!(t.length>e)},lengthBetween:function(t,e,n){return!(!this.minLength(t,e)||!this.maxLength(t,n))},startsWith:function(t,e){return!!t.startsWith(e)},endsWith:function(t,e){return!!t.endsWith(e)},includes:function(t,e){return!!t.includes(e)},in:function(t,e){return-1!==e.indexOf(t)},email:function(t){var e=/^\w+@\w+\.\w+$/;return!!e.test(t)},username:function(t){var e=/^[a-zA-Z0-9]\w+$/;return!!e.test(t)},phone:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"zh";switch(n){case"zh":e=/^(?:\+?(?:86))?(\s|-)?1\d{10}$/;break}return!!e.test(t)},regex:function(t,e){return"string"==typeof e&&(e=new RegExp(e)),!!e.test(t)},unique:function(t,e,n,s){return j("".concat(e,"/").concat(n),{where:{and:Object(Zt["a"])({},s,t)}}).then(function(t){return!t.data})}});function Yt(t,e){if("required"!==t&&!e&&0!==e)return!0;for(var n=arguments.length,s=new Array(n>2?n-2:0),r=2;r<n;r++)s[r-2]=arguments[r];return Jt[t].apply(Jt,[e].concat(s))}var Gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.total?n("div",{staticClass:"pagination"},[n("div",{staticClass:"btn-group"},[t.count>3?n("button",{class:(1==t.active?"active":"")+" item",on:{click:function(e){t.change(1)}}},[t._v("首页")]):t._e(),t.count>2?n("button",{staticClass:"item",on:{click:t.pre}},[t._v("上一页")]):t._e()]),n("div",{staticClass:"btn-group"},t._l(t.count,function(e,s){return n("span",{key:s},[Math.abs(e-t.active)<=t.radius?n("button",{staticClass:"item",class:e===t.active?"active":"",on:{click:function(n){t.onClick(e)}}},[t._v(t._s(e))]):t._e()])}),0),n("div",{staticClass:"btn-group"},[t.count>2?n("button",{staticClass:"item",on:{click:t.next}},[t._v("下一页")]):t._e(),t.count>3?n("button",{class:(t.active==t.count?"active":"")+" item",on:{click:function(e){t.change(t.count)}}},[t._v("末页")]):t._e()])]):t._e()},Qt=[],Xt={props:{total:{},limit:{},onChange:{},radius:{default:2}},data:function(){return{active:1}},computed:{count:function(){return Math.ceil(this.total/this.limit)}},mounted:function(){},methods:{onClick:function(t){this.change(t)},pre:function(){this.change(this.active-1)},next:function(){this.change(this.active+1)},change:function(t){t<1||t>this.count||(this.active=t,this.onChange&&this.onChange(t))}}},te=Xt,ee=(n("2723"),Object(g["a"])(te,Gt,Qt,!1,null,"0be5490e",null));ee.options.__file="Pagination.vue";var ne=ee.exports,se={components:{Pagination:ne},data:function(){return{createOrCancel:!1,list:{},current:{},timer:null,errors:{},total:0,valid:!0}},mounted:function(){this.read()},methods:{read:function(){var t=this;j("".concat(this.model,"/read"),this.readParams).then(function(e){t.list=e.data,t.total=e.total})},filp:function(t){this.readParams.page=t,this.read()},debounceValidate:function(t){var e=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e.validate(t)},500)},validate:function(t){var e=this,n=this.rules[t],s=!0,r=function(r){var a=n[r],i=a.params||[],o=Yt.apply(void 0,[r,e.current[t]].concat(Object(P["a"])(i)));"boolean"===typeof o?(o||(s=!1),e.afterValidate(t,r,o)):o.then(function(n){e.afterValidate(t,r,n),e.valid=n})};for(var a in n)r(a);return s},afterValidate:function(t,e,n){this.errors[t]||this.$set(this.errors,t,{}),this.$set(this.errors[t],e,!n)},validateForm:function(){var t=!0;for(var e in this.rules)this.validate(e)||(console.log(e,2),t=!1);return t},deleteUser:function(t){var e=this;confirm("确定删除")&&j("".concat(this.model,"/delete"),{id:t}).then(function(t){e.read()})},createOrUpdate:function(){var t,e=this;this.validateForm()&&this.valid&&(this.current.id?t="update":(t="create",this.beforCreateOrUpdate&&this.beforCreateOrUpdate()),j("".concat(this.model,"/").concat(t),this.current).then(function(t){e.read(),e.current={},e.createOrCancel=!1}))}}},re={mixins:[se],data:function(){return{model:"user",readParams:{page:1,limit:4},rules:{username:{required:{msg:"此项为必填项"},unique:{params:["user","exists","username"],msg:"用户名已存在"},lengthBetween:{params:[4,12],msg:"用户名长度应在4至12位之间"},regex:{params:[/^[a-zA-Z]+[0-9]*$/],msg:"用户名应由字母或数字组成,并且以字母为首"}},nickname:{regex:{params:[/^[a-zA-Z]+[0-9]*$/],msg:"昵称应由字母或数字组成,并且以字母为首"}},password:{required:{msg:"此项为必填项"},lengthBetween:{params:[6,32],msg:"密码长度在6到32位之间"},regex:{params:[/(?=.*[0-9])(?=.*[a-zA-Z])/],msg:"密码应包含数字和字母"}}}}}},ae=re,ie=Object(g["a"])(ae,Wt,Ht,!1,null,null,null);ie.options.__file="AdminUser.vue";var oe=ie.exports,ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"admin"}},[t._m(0),n("div",{staticClass:"create-post"},[n("button",{on:{click:function(e){t.createOrCancel=!t.createOrCancel,t.current={},t.errors={},t.cat=""}}},[0==t.createOrCancel?n("span",[t._v("创建帖子")]):n("span",[t._v("取消创建")])]),t.createOrCancel?n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.createOrUpdate(e)}}},[n("label",{on:{keyup:function(e){t.debounceValidate("title")}}},[n("div",[t._v("标题")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.title,expression:"current.title"}],attrs:{type:"text"},domProps:{value:t.current.title},on:{input:function(e){e.target.composing||t.$set(t.current,"title",e.target.value)}}}),t._l(t.errors.title,function(e,s){return n("div",{key:s,staticClass:"error"},[e?n("div",[t._v(t._s(t.rules.title[s].msg))]):t._e()])})],2),n("label",{on:{keyup:function(e){t.debounceValidate("cat")}}},[n("div",[n("span",[t._v("分类")]),t.cat?n("span",[t._v(": "+t._s(t.cat))]):t._e()]),n("DropdownCat",{attrs:{list:t.catList,displayBy:"name",searchBy:t.searchBy,onSelected:t.onSelected,current:t.current.$cat?t.current.$cat.name:""},on:{focus:t.reset}}),t._l(t.errors.cat,function(e,s){return n("div",{key:s,staticClass:"error"},[e?n("div",[t._v(t._s(t.rules.cat[s].msg))]):t._e()])})],2),n("label",{on:{keyup:function(e){t.debounceValidate("content")}}},[n("div",[t._v("内容")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.current.content,expression:"current.content"}],attrs:{type:"text"},domProps:{value:t.current.content},on:{input:function(e){e.target.composing||t.$set(t.current,"content",e.target.value)}}}),t._l(t.errors.content,function(e,s){return n("div",{key:s,staticClass:"error"},[e?n("div",[t._v(t._s(t.rules.content[s].msg))]):t._e()])})],2),n("button",{attrs:{type:"submit"}},[t._v("提交")])])]):t._e()]),n("div",{staticClass:"list"},[n("table",[t._m(1),n("tbody",t._l(t.list,function(e,s){return n("tr",{key:s},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.title))]),n("td",[t._v(t._s(e.$cat&&e.$cat.name||"-"))]),n("td",[t._v(t._s(e.create_at))]),n("td",[t._v(t._s(e.$user&&e.$user.username||"-"))]),n("td",[n("button",{on:{click:function(n){t.createOrCancel=!0,t.current=e,t.cat=""}}},[t._v("更新")]),n("button",{on:{click:function(n){t.deleteUser(e.id)}}},[t._v("删除")])])])}),0)]),n("Pagination",{attrs:{total:t.total,limit:t.readParams.limit,onChange:t.filp,radius:3}})],1)])},ue=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("帖子管理")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("ID")]),n("th",[t._v("标题")]),n("th",[t._v("分类")]),n("th",[t._v("日期")]),n("th",[t._v("作者")]),n("th",[t._v("操作")])])}],le=(n("7f7f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dropdown"}},[n("div",{staticClass:"filter"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"selected-cat",domProps:{value:t.keyword},on:{focus:function(e){t.show=!0,t.$emit("focus")},blur:t.hide,keyup:t.filter,input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),t.show?n("span",t._l(t.result,function(e,s){return n("div",{key:s,staticClass:"select",on:{mousedown:function(n){t.select(e)}}},[t._v(t._s(e[t.displayBy]))])}),0):t._e()])])}),de=[],ve={props:["list","displayBy","searchBy","onSelected","current"],data:function(){return{result:[],keyword:"",show:!1}},mounted:function(){this.result=this.list,this.current&&(this.keyword=this.current)},methods:{filter:function(){var t=this;this.result=this.list.filter(function(e){return e[t.searchBy].includes(t.keyword)})},hide:function(){var t=this;setTimeout(function(){t.show=!1},10)},select:function(t){this.onSelected&&(this.onSelected(t),this.keyword=t.name,this.result=[])}}},me=ve,pe=(n("e231"),Object(g["a"])(me,le,de,!1,null,"5cda10d0",null));pe.options.__file="DropdownCat.vue";var fe=pe.exports,he={mixins:[se],components:{DropdownCat:fe},data:function(){return{model:"post",readParams:{limit:8,page:1,with:[{model:"user",relation:"belongs_to"},{model:"cat",relation:"belongs_to"}]},rules:{title:{required:{msg:"此项为必填项"}}},list:[],catList:[],searchBy:"name",cat:""}},mounted:function(){var t=this;j("cat/read").then(function(e){t.catList=e.data})},methods:{onSelected:function(t){this.current.cat_id=t.id,this.cat=t.name},reset:function(){this.current.cat_id=null,this.cat=""},beforCreateOrUpdate:function(){this.current.user_id=f.user().id,this.current.create_at=z.format(new Date)}}},_e=he,ge=Object(g["a"])(_e,ce,ue,!1,null,null,null);ge.options.__file="AdminPost.vue";var we=ge.exports,Ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"admin"}},[t._m(0),n("div",{staticClass:"create-post"},[n("button",{on:{click:function(e){t.createOrCancel=!t.createOrCancel,t.current={},t.errors={}}}},[0==t.createOrCancel?n("span",[t._v("创建分类")]):n("span",[t._v("取消创建")])]),t.createOrCancel?n("div",[n("form",{on:{submit:function(e){return e.preventDefault(),t.createOrUpdate(e)}}},[n("label",{on:{keyup:function(e){t.debounceValidate("name")}}},[n("div",[t._v("名称")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.current.name,expression:"current.name"}],attrs:{type:"text"},domProps:{value:t.current.name},on:{input:function(e){e.target.composing||t.$set(t.current,"name",e.target.value)}}}),t._l(t.errors.name,function(e,s){return n("div",{key:s,staticClass:"error"},[e?n("div",[t._v(t._s(t.rules.name[s].msg))]):t._e()])})],2),n("button",{attrs:{type:"submit"}},[t._v("提交")])])]):t._e()]),n("div",{staticClass:"list"},[n("table",[t._m(1),n("tbody",t._l(t.list,function(e,s){return n("tr",{key:s},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.name))]),n("td",[n("button",{on:{click:function(n){t.createOrCancel=!0,t.current=e}}},[t._v("更新")]),n("button",{on:{click:function(n){t.deleteUser(e.id)}}},[t._v("删除")])])])}),0)]),n("Pagination",{attrs:{total:t.total,limit:t.readParams.limit,onChange:t.filp,radius:3}})],1)])},be=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("分类管理")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("ID")]),n("th",[t._v("分类")]),n("th",[t._v("操作")])])}],ye={mixins:[se],data:function(){return{model:"cat",readParams:{limit:4,page:1},rules:{name:{required:{msg:"此项为必填项"},unique:{params:["cat","exists","name"],msg:"分类已存在"}}}}}},ke=ye,Pe=Object(g["a"])(ke,Ce,be,!1,null,null,null);Pe.options.__file="AdminCat.vue";var xe=Pe.exports,$e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"admin"}},[t._m(0),n("div",{staticClass:"list"},[n("table",[t._m(1),n("tbody",t._l(t.list,function(e,s){return n("tr",{key:s},[n("td",[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.$user&&e.$user.username||"-"))]),n("td",[t._v(t._s(e.create_at))]),n("td",[t._v(t._s(e.$post&&e.$post.title||"-"))]),n("td",[t._v(t._s(e.content))]),n("td",[n("button",{on:{click:function(n){t.deleteUser(e.id)}}},[t._v("删除")])])])}),0)]),n("Pagination",{attrs:{total:t.total,limit:t.readParams.limit,onChange:t.filp,radius:3}})],1)])},Oe=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v("评论管理")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("th",[t._v("ID")]),n("th",[t._v("作者")]),n("th",[t._v("日期")]),n("th",[t._v("帖子")]),n("th",[t._v("评论")]),n("th",[t._v("操作")])])}],Me={mixins:[se],data:function(){return{model:"comment",readParams:{limit:10,page:1,with:[{model:"user",relation:"belongs_to"},{model:"post",relation:"belongs_to"}]}}}},Ee=Me,Se=Object(g["a"])(Ee,$e,Oe,!1,null,null,null);Se.options.__file="AdminComment.vue";var Ve=Se.exports;s["a"].use(b["a"]),s["a"].config.productionTip=!1;var je=new b["a"]({routes:[{path:"/",component:K},{path:"/member",component:pt},{path:"/signup",component:nt},{path:"/login",component:ct},{path:"/post/:id",component:Y},{path:"/setting",component:Ct,children:[{path:"me",component:Ot},{path:"security",component:Nt}]},{path:"/admin",component:zt,children:[{path:"user",component:oe},{path:"post",component:we},{path:"cat",component:xe},{path:"comment",component:Ve}]}]});je.beforeEach(function(t,e,n){/admin/.test(t.matched[0].path)?f.user()&&f.user().IS_ADMIN?n():n(!1):n()}),new s["a"]({render:function(t){return t(C)},router:je}).$mount("#app")},"585e":function(t,e,n){},"910d":function(t,e,n){},"91ee":function(t,e,n){"use strict";var s=n("ff04"),r=n.n(s);r.a},"9f87":function(t,e,n){},d76d:function(t,e,n){"use strict";var s=n("dda9"),r=n.n(s);r.a},dda9:function(t,e,n){},e231:function(t,e,n){"use strict";var s=n("910d"),r=n.n(s);r.a},e58e:function(t,e,n){"use strict";var s=n("fca9"),r=n.n(s);r.a},f430:function(t,e,n){t.exports=n.p+"img/logo-sm.a2b97f92.png"},f771:function(t,e,n){},f89c:function(t,e,n){"use strict";var s=n("ff31"),r=n.n(s);r.a},fca9:function(t,e,n){},ff04:function(t,e,n){},ff31:function(t,e,n){}});
//# sourceMappingURL=app.5c8e95e1.js.map